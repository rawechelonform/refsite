<!doctype html>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Crosshair — Soft Mode (no pointer lock)</title>
<style>
  html,body{height:100%;margin:0;background:#111;color:#ddd;font:14px/1.5 system-ui}

  /* Hide native cursor only while inside the page */
  .hide-native body, .hide-native body *{ cursor:none !important; }

  :root{--s:34px;--t:2px;--g:18px;--d:3px}
  #c{
    position:fixed;left:0;top:0;width:var(--s);height:var(--s);
    transform:translate(-50%,-50%);pointer-events:none;z-index:2147483646;
    color:#fff;filter:drop-shadow(0 0 1px #000) drop-shadow(0 0 2px #000) drop-shadow(0 0 3px #000);
    display:none; /* shown after first in-page move */
  }
  #c .arm{
    position:absolute;left:50%;top:50%;width:var(--s);height:var(--t);transform-origin:50% 50%;
    background:linear-gradient(90deg,currentColor 0 calc(50% - (var(--g)/2)),
      transparent calc(50% - (var(--g)/2)) calc(50% + (var(--g)/2)),
      currentColor calc(50% + (var(--g)/2)) 100%)}
  #c .arm-a{transform:translate(-50%,-50%) rotate(45deg)}
  #c .arm-b{transform:translate(-50%,-50%) rotate(-45deg)}
  #c .dot{position:absolute;left:50%;top:50%;width:var(--d);height:var(--d);
          transform:translate(-50%,-50%);border-radius:50%;background:currentColor}

  /* idle spin (random; triggered in JS) */
  @keyframes spin{from{transform:translate(-50%,-50%) rotate(0)}to{transform:translate(-50%,-50%) rotate(360deg)}}

  /* click = squeeze */
  #c.implode .arm-a,#c.implode .arm-b{animation:arm-implode 220ms ease-out forwards}
  @keyframes arm-implode{
    0%{transform:translate(-50%,-50%) rotate(var(--deg,45deg)) scaleX(1)}
    60%{transform:translate(-50%,-50%) rotate(var(--deg,45deg)) scaleX(.25)}
    100%{transform:translate(-50%,-50%) rotate(var(--deg,45deg)) scaleX(0)}
  }
  #c.implode .arm-a{--deg:45deg} #c.implode .arm-b{--deg:-45deg}

  @media (prefers-reduced-motion: reduce){
    #c{animation:none !important}
    #c.implode .arm-a,#c.implode .arm-b{animation:none !important}
  }
</style>

<body>
  <!-- Crosshair -->
  <div id="c" aria-hidden="true">
    <span class="arm arm-a"></span>
    <span class="arm arm-b"></span>
    <span class="dot"></span>
  </div>

<script>
(() => {
  const root = document.documentElement;
  const c    = document.getElementById('c');

  let x = innerWidth/2, y = innerHeight/2;
  let lastMoveTs = 0;
  let pendingShowOnFirstMove = false;

  const clamp = (v,min,max)=> v<min?min : v>max?max : v;
  const now   = ()=> performance.now();
  const rand  = (a,b)=> Math.random()*(b-a)+a;
  const prefersReduce = matchMedia('(prefers-reduced-motion: reduce)').matches;

  const show = ()=>{ if (c.style.display!=='block') c.style.display='block'; };
  const hide = ()=>{ if (c.style.display!=='none')  c.style.display='none';  };
  const place = ()=>{ c.style.left = x+'px'; c.style.top = y+'px'; };

  // Enter/leave: hide OS cursor inside, show it outside. Crosshair only appears
  // after the first real in-page move to avoid 1-frame double-cursor flashes.
  addEventListener('mouseenter', () => {
    root.classList.add('hide-native');
    pendingShowOnFirstMove = true;
  });
  addEventListener('mouseleave', () => {
    root.classList.remove('hide-native');
    pendingShowOnFirstMove = false;
    hide();
  });

  // Follow normal clientX/Y (no pointer lock = no “stuck at edge”, no unlocks)
  addEventListener('pointermove', (e) => {
    x = clamp(e.clientX, 0, innerWidth-1);
    y = clamp(e.clientY, 0, innerHeight-1);
    place();
    lastMoveTs = now();
    if (pendingShowOnFirstMove){ pendingShowOnFirstMove = false; show(); }
  }, { passive:true });

  // Click = squeeze/implode
  addEventListener('pointerdown', () => {
    c.classList.remove('implode'); void c.offsetWidth;
    c.classList.add('implode');
    setTimeout(()=>c.classList.remove('implode'), 240);
  }, true);

  // Random idle spins
  let spinTimer=null;
  function scheduleSpin(){
    clearTimeout(spinTimer);
    spinTimer = setTimeout(()=>{
      if (!prefersReduce && (now()-lastMoveTs > 220)){
        const rev = Math.random()<.5, dur = Math.round(rand(260,680));
        c.style.animation='none'; void c.offsetWidth;
        c.style.animation=`spin ${dur}ms ease-out ${rev?'reverse':'normal'}`;
      }
      scheduleSpin();
    }, Math.round(rand(1200,4200)));
  }

  // Keep within bounds on resize
  addEventListener('resize', () => {
    x = clamp(x, 0, innerWidth-1);
    y = clamp(y, 0, innerHeight-1);
    place();
  });

  // Boot
  place();
  // Mark as “inside” if page loads with pointer already over it
  root.classList.add('hide-native');
  pendingShowOnFirstMove = true;
  scheduleSpin();
})();
</script>
</body>
